/** @decorator */

import { WorkspacePage } from '../../base/workspace/workspace-page.js';
import { html } from '../../lib/template.js';
import { css } from '../../lib/element/styles/css.js';
import { when } from '../../lib/element/templating/when.js';
import { ref } from '../../lib/element/templating/ref.js';
import {
  basePageStyles,
  loadingIndicator
} from '../../design/leafygreen/styles/page.js';

const noWidgetsTemplate = html`
  <${'ppp-page-header'}>
    ${(x) => x.app.workspaces.find((i) => i.uuid === x.app.workspace)?._id}
  </ppp-page-header>
  <form ${ref('form')} id="workspace" name="workspace" onsubmit="return false">
    <div class="loading-wrapper" ?busy="${(x) => x.busy}">
      <div class="empty-state">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="66"
          height="58"
          viewBox="0 0 66 58"
          fill="none"
        >
          <path
            d="M29 57V3C29 1.89543 28.1046 1 27 1H31C32.1046 1 33 1.89543 33 3V57H29Z"
            fill="#00ED64"
            stroke="#001E2B"
          />
          <path
            d="M61 55V19C61 17.8954 60.1046 17 59 17H63C64.1046 17 65 17.8954 65 19V55C65 56.1046 64.1046 57 63 57H59C60.1046 57 61 56.1046 61 55Z"
            fill="#00ED64"
            stroke="#001E2B"
          />
          <path
            d="M38.9999 35.0001V41.0001M46.9999 35V41M54.9999 35V41M36 17H35C33.8954 17 33 17.8954 33 19V57H59C60.1046 57 61 56.1046 61 55V19C61 17.8954 60.1046 17 59 17H58M51 57V49C51 47.8954 50.1046 47 49 47H45C43.8954 47 43 47.8954 43 49V57H51Z"
            stroke="#001E2B"
            stroke-miterlimit="10"
          />
          <path
            d="M6.99994 8.00012V14.0001M14.9999 8V14M22.9999 8V14M29 57V3C29 1.89543 28.1046 1 27 1H3C1.89543 1 1 1.89543 1 3V55C1 56.1046 1.89543 57 3 57H29ZM20 57V47C20 45.8954 19.1046 45 18 45H12C10.8954 45 10 45.8954 10 47L10 57H20Z"
            stroke="#001E2B"
            stroke-miterlimit="10"
          />
          <path
            d="M37.0489 32.3374L35.0559 31.6051C34.951 31.6051 34.8461 31.5005 34.7412 31.5005C33.2727 30.7681 32.6433 29.0942 33.3776 27.5249L34.3216 25.6417C34.7412 24.8048 34.7412 23.9678 34.3216 23.1308C33.5874 21.6661 31.909 21.0384 30.4405 21.7708L29.916 21.98L28.5524 22.6077C28.4475 22.6077 28.3426 22.7124 28.2377 22.7124C26.6643 23.2355 24.986 22.5031 24.4615 20.9338L23.7273 18.946C23.5175 18.4229 23.0979 17.8998 22.6783 17.5859C22.4685 17.3767 22.2587 17.2721 21.9441 17.1675C20.3706 16.6444 18.6923 17.3767 18.1678 18.946L17.4336 20.9338C17.4336 21.0384 17.3287 21.143 17.3287 21.2477C16.5944 22.7124 14.9161 23.3401 13.4476 22.6077L11.5595 21.6662C10.7203 21.2477 9.88116 21.2477 9.04201 21.6662C7.57348 22.3985 6.94411 24.0724 7.67838 25.5371L8.62243 27.4203C8.62243 27.5249 8.72732 27.6295 8.72732 27.7341C9.2518 29.3034 8.51753 30.9774 6.94411 31.5005L4.95111 32.2328C4.11196 32.5467 3.48259 33.1744 3.1679 34.0114C2.64343 35.5807 3.37769 37.2546 4.95111 37.7777L6.94411 38.5101C7.04901 38.5101 7.1539 38.6147 7.2588 38.6147C8.72732 39.347 9.35669 41.0209 8.62243 42.5903L7.57348 44.4734C7.1539 45.3104 7.1539 46.252 7.57348 46.9843C8.30774 48.449 9.98606 49.0767 11.4546 48.3444L13.3427 47.4028C13.4476 47.4028 13.5525 47.2982 13.6574 47.2982C15.2308 46.7751 16.9091 47.5074 17.4336 49.0767L18.1678 51.0645C18.4825 51.9015 19.1119 52.5292 19.9511 52.8431C20.6853 53.0523 21.4196 53.0523 22.0489 52.8431C22.7832 52.5292 23.4126 51.9015 23.7273 51.0645L24.4615 49.0767C24.4615 48.9721 24.5664 48.8675 24.5664 48.7629C25.3007 47.2982 26.979 46.6705 28.4475 47.4028L29.8112 48.0305L30.3356 48.2398C31.1748 48.5536 32.0139 48.5536 32.8531 48.2398C34.3216 47.5074 34.951 45.8335 34.3216 44.3688L33.3776 42.4856C33.3776 42.381 33.2727 42.2764 33.2727 42.1718C32.7482 40.6025 33.4825 38.9285 35.0559 38.4054L37.0489 37.6731C37.888 37.3592 38.5174 36.7315 38.8321 35.8945C39.3566 34.5345 38.6223 32.8605 37.0489 32.3374ZM22.2587 41.9625C21.8392 42.0672 21.4196 42.0672 21 42.0672C17.1189 42.0672 13.9721 38.9285 13.9721 35.0576C13.9721 31.1866 17.1189 28.048 21 28.048C21.5245 28.048 22.0489 28.1526 22.5734 28.2572C25.7203 28.9896 28.0279 31.7097 28.0279 35.0576C27.923 38.5101 25.5105 41.3348 22.2587 41.9625Z"
            fill="#00ED64"
            stroke="#001E2B"
            stroke-miterlimit="10"
          />
          <path
            d="M56.8077 15.3729L55.5897 14.9253C55.5256 14.9253 55.4615 14.8614 55.3974 14.8614C54.5 14.4139 54.1154 13.3909 54.5641 12.4319L55.141 11.2811C55.3974 10.7696 55.3974 10.2581 55.141 9.74662C54.6923 8.85154 53.6666 8.46793 52.7692 8.91547L52.4487 9.04334L51.6154 9.42695C51.5513 9.42695 51.4872 9.49088 51.4231 9.49088C50.4615 9.81056 49.4359 9.36301 49.1154 8.40399L48.6667 7.18923C48.5385 6.86956 48.282 6.54988 48.0256 6.35808C47.8974 6.23021 47.7692 6.16627 47.5769 6.10234C46.6154 5.78267 45.5897 6.23021 45.2692 7.18923L44.8205 8.40399C44.8205 8.46793 44.7564 8.53186 44.7564 8.5958C44.3077 9.49088 43.2821 9.87449 42.3846 9.42695L41.2308 8.85154C40.718 8.5958 40.2052 8.5958 39.6923 8.85154C38.7949 9.29908 38.4103 10.322 38.859 11.2171L39.4359 12.3679C39.4359 12.4319 39.5 12.4958 39.5 12.5598C39.8205 13.5188 39.3718 14.5417 38.4103 14.8614L37.1923 15.3089C36.6795 15.5008 36.2949 15.8844 36.1026 16.3958C35.7821 17.3549 36.2308 18.3778 37.1923 18.6975L38.4103 19.145C38.4744 19.145 38.5385 19.209 38.6026 19.209C39.5 19.6565 39.8846 20.6795 39.4359 21.6385L38.7949 22.7893C38.5385 23.3008 38.5385 23.8762 38.7949 24.3238C39.2436 25.2188 40.2693 25.6024 41.1667 25.1549L42.3205 24.5795C42.3846 24.5795 42.4487 24.5156 42.5128 24.5156C43.4744 24.1959 44.5 24.6434 44.8205 25.6024L45.2692 26.8172C45.4615 27.3287 45.8462 27.7123 46.359 27.9041C46.8077 28.032 47.2564 28.032 47.641 27.9041C48.0897 27.7123 48.4744 27.3287 48.6667 26.8172L49.1154 25.6024C49.1154 25.5385 49.1795 25.4746 49.1795 25.4106C49.6282 24.5156 50.6538 24.1319 51.5513 24.5795L52.3846 24.9631L52.7051 25.091C53.2179 25.2828 53.7307 25.2828 54.2436 25.091C55.141 24.6434 55.5256 23.6205 55.141 22.7254L54.5641 21.5746C54.5641 21.5106 54.5 21.4467 54.5 21.3827C54.1795 20.4237 54.6282 19.4008 55.5897 19.0811L56.8077 18.6336C57.3205 18.4418 57.7051 18.0581 57.8974 17.5467C58.2179 16.7155 57.7692 15.6926 56.8077 15.3729ZM47.7692 21.2549C47.5128 21.3188 47.2564 21.3188 47 21.3188C44.6282 21.3188 42.7051 19.4008 42.7051 17.0352C42.7051 14.6696 44.6282 12.7516 47 12.7516C47.3205 12.7516 47.641 12.8155 47.9615 12.8794C49.8846 13.327 51.2949 14.9893 51.2949 17.0352C51.2308 19.145 49.7564 20.8713 47.7692 21.2549Z"
            stroke="#001E2B"
            stroke-miterlimit="10"
          />
        </svg>
        <h1>Этот терминал не настроен</h1>
        <h2>
          Для того, чтобы начать торговать, разместите виджеты в этой рабочей
          области
        </h2>
        <button
          type="button"
          class="cta"
          aria-disabled="false"
          role="link"
          disabled
        >
          <div class="text">Добавить виджет</div>
        </button>
      </div>
    </div>
  </form>
`;

export const workspacePageTemplate = (context, definition) => html`
  <template>
    <div class="loading-wrapper" ?busy="${(x) => x.busy}">
      ${when((x) => x.busy, html`${loadingIndicator()}`)}
      ${when(
        (x) => x.notFound,
        html` <ppp-not-found-page :app="${(x) => x}"></ppp-not-found-page>`
      )}
      ${when((x) => !x.busy && !x.notFound && !x.widgets.length, noWidgetsTemplate)}
    </div>
  </template>
`;

export const workspacePageStyles = (context, definition) => css`
  ${basePageStyles}
  .loading-wrapper {
    margin-top: 8px;
  }
`;

export const workspacePage = WorkspacePage.compose({
  baseName: 'workspace-page',
  template: workspacePageTemplate,
  styles: workspacePageStyles
});
